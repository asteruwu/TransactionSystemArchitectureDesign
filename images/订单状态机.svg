<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: #ffffff; background-color: #ffffff; color-scheme: light;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="508px" height="630px" viewBox="-0.5 -0.5 508 630" content="&lt;mxfile host=&quot;Electron&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.2.5 Chrome/138.0.7204.251 Electron/37.6.1 Safari/537.36&quot; scale=&quot;1&quot; border=&quot;0&quot; version=&quot;28.2.5&quot;&gt;&#10;  &lt;diagram id=&quot;vNxxpNZaLDLKTTsMgnAr&quot; name=&quot;第 6 页&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1042&quot; dy=&quot;722&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;1200&quot; pageHeight=&quot;1500&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-1&quot; value=&quot;&quot; style=&quot;ellipse;fillColor=strokeColor;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;596&quot; y=&quot;220&quot; width=&quot;14&quot; height=&quot;14&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-2&quot; value=&quot;PENDING&quot; style=&quot;rounded=1;arcSize=20;strokeWidth=2;shadow=1;strokeColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;563&quot; y=&quot;342&quot; width=&quot;79&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-3&quot; value=&quot;PAID&quot; style=&quot;rounded=1;arcSize=20;strokeWidth=2;shadow=1;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;strokeColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;488&quot; y=&quot;507&quot; width=&quot;47&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-4&quot; value=&quot;CANCELLED&quot; style=&quot;rounded=1;arcSize=20;strokeWidth=2;shadow=1;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;strokeColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;743&quot; y=&quot;507&quot; width=&quot;98&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-5&quot; value=&quot;SHIPPED&quot; style=&quot;rounded=1;arcSize=20;strokeWidth=2;shadow=1;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;strokeColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;474&quot; y=&quot;802&quot; width=&quot;75&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-6&quot; value=&quot;SHIP_FAILED&quot; style=&quot;rounded=1;arcSize=20;strokeWidth=2;shadow=1;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=12;fontColor=default;fillColor=default;strokeColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;552&quot; y=&quot;663&quot; width=&quot;103&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-7&quot; value=&quot;Lua 扣减库存成功&amp;#xa;(Redis Stream → order_created Consumer)&quot; style=&quot;curved=1;startArrow=none;;exitX=0.49;exitY=1;entryX=0.51;entryY=-0.01;rounded=0;&quot; parent=&quot;1&quot; source=&quot;rhbHhM7paaSlAsIb1_o0-1&quot; target=&quot;rhbHhM7paaSlAsIb1_o0-2&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-8&quot; value=&quot;支付成功&amp;#xa;(order_status_events Consumer)&quot; style=&quot;curved=1;startArrow=none;;exitX=0.01;exitY=0.94;entryX=0.04;entryY=-0.01;rounded=0;&quot; parent=&quot;1&quot; source=&quot;rhbHhM7paaSlAsIb1_o0-2&quot; target=&quot;rhbHhM7paaSlAsIb1_o0-3&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;421&quot; y=&quot;444&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-9&quot; value=&quot;超时未支付&amp;#xa;(Cleanup Worker&amp;#xa;确认未付 → Restock → 取消)&quot; style=&quot;curved=1;startArrow=none;;exitX=1.01;exitY=0.92;entryX=0.5;entryY=-0.01;rounded=0;&quot; parent=&quot;1&quot; source=&quot;rhbHhM7paaSlAsIb1_o0-2&quot; target=&quot;rhbHhM7paaSlAsIb1_o0-4&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;792&quot; y=&quot;444&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-10&quot; value=&quot;Cleanup Worker&amp;#xa;(确认已付 → 修复状态)&quot; style=&quot;curved=1;startArrow=none;;exitX=0.51;exitY=0.99;entryX=0.98;entryY=-0.01;rounded=0;&quot; parent=&quot;1&quot; source=&quot;rhbHhM7paaSlAsIb1_o0-2&quot; target=&quot;rhbHhM7paaSlAsIb1_o0-3&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;603&quot; y=&quot;444&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-11&quot; value=&quot;发货成功&amp;#xa;(Consumer 触发 / Recover 补偿)&quot; style=&quot;curved=1;startArrow=none;;exitX=0.01;exitY=0.97;entryX=0.13;entryY=0;rounded=0;&quot; parent=&quot;1&quot; source=&quot;rhbHhM7paaSlAsIb1_o0-3&quot; target=&quot;rhbHhM7paaSlAsIb1_o0-5&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;420&quot; y=&quot;601&quot; /&gt;&#10;              &lt;mxPoint x=&quot;420&quot; y=&quot;757&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-12&quot; value=&quot;发货失败&amp;#xa;(ShippingRecoverWorker 重试超限)&quot; style=&quot;curved=1;startArrow=none;;exitX=1.01;exitY=0.97;entryX=0.5;entryY=0;rounded=0;&quot; parent=&quot;1&quot; source=&quot;rhbHhM7paaSlAsIb1_o0-3&quot; target=&quot;rhbHhM7paaSlAsIb1_o0-6&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;603&quot; y=&quot;601&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rhbHhM7paaSlAsIb1_o0-13&quot; value=&quot;ShippingRecoverWorker&amp;#xa;(下一轮重试成功)&quot; style=&quot;curved=1;startArrow=none;;exitX=0.5;exitY=1;entryX=0.88;entryY=0;rounded=0;&quot; parent=&quot;1&quot; source=&quot;rhbHhM7paaSlAsIb1_o0-6&quot; target=&quot;rhbHhM7paaSlAsIb1_o0-5&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;603&quot; y=&quot;757&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><rect fill="#ffffff" width="100%" height="100%" x="0" y="0" style="fill: rgb(255, 255, 255);"/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="rhbHhM7paaSlAsIb1_o0-1"><g><ellipse cx="264" cy="7" rx="7" ry="7" fill="#000000" stroke="#000000" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-2"><g style="filter: drop-shadow(rgba(0, 0, 0, 0.25) 2px 3px 2px);"><rect x="224" y="122" width="79" height="40" rx="8" ry="8" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px" style="fill: rgb(0, 0, 0);"><text x="263.5" y="147">PENDING</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-3"><g style="filter: drop-shadow(rgba(0, 0, 0, 0.25) 2px 3px 2px);"><rect x="149" y="287" width="47" height="40" rx="8" ry="8" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px" style="fill: rgb(0, 0, 0);"><text x="172.5" y="312">PAID</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-4"><g style="filter: drop-shadow(rgba(0, 0, 0, 0.25) 2px 3px 2px);"><rect x="404" y="287" width="98" height="40" rx="8" ry="8" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px" style="fill: rgb(0, 0, 0);"><text x="453" y="312">CANCELLED</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-5"><g style="filter: drop-shadow(rgba(0, 0, 0, 0.25) 2px 3px 2px);"><rect x="135" y="582" width="75" height="40" rx="8" ry="8" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px" style="fill: rgb(0, 0, 0);"><text x="172.5" y="607">SHIPPED</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-6"><g style="filter: drop-shadow(rgba(0, 0, 0, 0.25) 2px 3px 2px);"><rect x="213" y="443" width="103" height="40" rx="8" ry="8" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px" style="fill: rgb(0, 0, 0);"><text x="264.5" y="468">SHIP_FAILED</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-7"><g><path d="M 264 14 Q 264 14 264.26 115.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: rgb(0, 0, 0);"/><path d="M 264.27 120.88 L 260.75 113.89 L 264.26 115.63 L 267.75 113.87 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px" style="fill: rgb(0, 0, 0);"><rect fill="#ffffff" stroke="none" x="157" y="55" width="215" height="27" stroke-width="0" style="fill: rgb(255, 255, 255);"/><text x="264.14" y="66">Lua 扣减库存成功</text><text x="264.14" y="79">(Redis Stream → order_created Consumer)</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-8"><g><path d="M 224 159.96 Q 82 224 146.59 282.72" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: rgb(0, 0, 0);"/><path d="M 150.48 286.25 L 142.94 284.13 L 146.59 282.72 L 147.65 278.95 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px" style="fill: rgb(0, 0, 0);"><rect fill="#ffffff" stroke="none" x="29" y="199" width="163" height="27" stroke-width="0" style="fill: rgb(255, 255, 255);"/><text x="110.05" y="209.35">支付成功</text><text x="110.05" y="222.35">(order_status_events Consumer)</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-9"><g><path d="M 303 158.47 Q 453 224 453 280.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: rgb(0, 0, 0);"/><path d="M 453 285.88 L 449.5 278.88 L 453 280.63 L 456.5 278.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px" style="fill: rgb(0, 0, 0);"><rect fill="#ffffff" stroke="none" x="334" y="184" width="146" height="41" stroke-width="0" style="fill: rgb(255, 255, 255);"/><text x="406.55" y="195.21">超时未支付</text><text x="406.55" y="208.21">(Cleanup Worker</text><text x="406.55" y="221.21">确认未付 → Restock → 取消)</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-10"><g><path d="M 264.31 162 Q 264 224 199.33 282.72" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: rgb(0, 0, 0);"/><path d="M 195.45 286.25 L 198.27 278.95 L 199.33 282.72 L 202.98 284.13 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px" style="fill: rgb(0, 0, 0);"><rect fill="#ffffff" stroke="none" x="196" y="222" width="114" height="27" stroke-width="0" style="fill: rgb(255, 255, 255);"/><text x="252.16" y="232.76">Cleanup Worker</text><text x="252.16" y="245.76">(确认已付 → 修复状态)</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-11"><g><path d="M 149 326.18 Q 81 381 81 459 Q 81 537 139.55 578.33" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: rgb(0, 0, 0);"/><path d="M 143.84 581.36 L 136.1 580.18 L 139.55 578.33 L 140.14 574.46 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px" style="fill: rgb(0, 0, 0);"><rect fill="#ffffff" stroke="none" x="2" y="442" width="160" height="27" stroke-width="0" style="fill: rgb(255, 255, 255);"/><text x="81" y="452.66">发货成功</text><text x="81" y="465.66">(Consumer 触发 / Recover 补偿)</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-12"><g><path d="M 196 325.43 Q 264 381 264.45 436.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: rgb(0, 0, 0);"/><path d="M 264.49 441.88 L 260.93 434.91 L 264.45 436.63 L 267.93 434.85 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px" style="fill: rgb(0, 0, 0);"><rect fill="#ffffff" stroke="none" x="167" y="360" width="175" height="27" stroke-width="0" style="fill: rgb(255, 255, 255);"/><text x="254.08" y="370.89">发货失败</text><text x="254.08" y="383.89">(ShippingRecoverWorker 重试超限)</text></g></g></g><g data-cell-id="rhbHhM7paaSlAsIb1_o0-13"><g><path d="M 264.5 483 Q 264 537 206.18 578.3" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: rgb(0, 0, 0);"/><path d="M 201.91 581.35 L 205.57 574.43 L 206.18 578.3 L 209.64 580.13 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: rgb(0, 0, 0); stroke: rgb(0, 0, 0);"/></g><g><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px" style="fill: rgb(0, 0, 0);"><rect fill="#ffffff" stroke="none" x="194" y="531" width="121" height="27" stroke-width="0" style="fill: rgb(255, 255, 255);"/><text x="254.24" y="541.97">ShippingRecoverWorker</text><text x="254.24" y="554.97">(下一轮重试成功)</text></g></g></g></g></g></g></svg>